<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BACKROOMS - Windows Edition</title>
    <link rel="stylesheet" href="style.css">
    <style>
        /* Estilos espec√≠ficos para Windows */
        .window-titlebar {
            -webkit-app-region: drag;
            height: 30px;
            background: #1a1a1a;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000000;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 10px;
            color: #f0e68c;
            font-family: 'VT323', monospace;
            border-bottom: 1px solid #8b1e3f;
        }

        .window-controls {
            -webkit-app-region: no-drag;
        }

        .window-controls button {
            background: none;
            border: none;
            color: #f0e68c;
            width: 30px;
            height: 30px;
            cursor: pointer;
        }

        .window-controls button:hover {
            background: #8b1e3f;
        }

        body {
            padding-top: 30px;
        }

        .game-hud {
            bottom: 30px;
        }

        /* Indicador de vers√£o Windows */
        .windows-badge {
            position: fixed;
            bottom: 10px;
            right: 10px;
            color: #444;
            font-size: 10px;
            font-family: monospace;
            z-index: 1000000;
        }
    </style>
</head>
<body>
    <!-- Windows Title Bar -->
    <div class="window-titlebar">
        <span>üéÆ BACKROOMS - Windows Edition</span>
        <div class="window-controls">
            <button id="minimizeBtn">‚îÄ</button>
            <button id="maximizeBtn">‚ñ°</button>
            <button id="closeBtn">‚úï</button>
        </div>
    </div>

    <!-- System Info -->
    <div class="system-info" style="top: 40px;">
        <div>FPS: <span id="fpsValue">60</span></div>
        <div>RAM: <span id="ramValue">0 MB</span></div>
        <div>WINDOWS</div>
    </div>

    <!-- Save Manager -->
    <div class="save-manager" id="saveManager" style="display: none;">
        <div class="save-manager-content">
            <h2>üíæ GERENCIAR SAVES</h2>
            <div id="saveList" class="save-list"></div>
            <button class="menu-btn" id="closeSaveManager">FECHAR</button>
        </div>
    </div>

    <!-- Restante do jogo (mesmo c√≥digo anterior) -->
    <div class="effect-layer">
        <div class="static"></div>
        <div class="scanlines"></div>
        <div class="vignette"></div>
        <div class="flicker"></div>
    </div>

    <div class="loading-screen" id="loadingScreen">
        <!-- Loading content -->
    </div>

    <div class="intro-cinematic" id="introCinematic">
        <!-- Intro content -->
    </div>

    <div class="menu-container" id="menuContainer">
        <div class="menu-content">
            <h1 class="menu-title">BACKROOMS</h1>
            <h2 style="color: #8b1e3f; margin-bottom: 2rem;">WINDOWS EDITION</h2>
            <div class="menu-buttons">
                <button class="menu-btn" id="newGameBtn">üéÆ NOVO JOGO</button>
                <button class="menu-btn" id="continueBtn">üíæ CONTINUAR</button>
                <button class="menu-btn" id="loadGameBtn">üìÇ CARREGAR SAVE</button>
                <button class="menu-btn" id="settingsBtn">‚öôÔ∏è CONFIGURA√á√ïES</button>
                <button class="menu-btn" id="exitBtn">‚ùå SAIR</button>
            </div>
        </div>
    </div>

    <div class="game-hud" id="gameHud">
        <div>üß† SANIDADE</div>
        <div class="sanity-bar">
            <div class="sanity-fill" id="sanityFill"></div>
        </div>
        <div>N√çVEL <span id="currentLevel">0</span> - <span id="levelName">THE OFFICE</span></div>
    </div>

    <div id="canvas-container"></div>

    <div class="windows-badge">BACKROOMS v1.0 ‚Ä¢ Windows Native</div>

    <audio id="humSound" loop>
        <source src="assets/sounds/hum.mp3" type="audio/mpeg">
    </audio>

    <script>
        // Integra√ß√£o com Electron
        const { electronAPI } = window;

        // Controles da janela
        document.getElementById('minimizeBtn').addEventListener('click', () => {
            if (electronAPI) electronAPI.send('minimize-window');
        });

        document.getElementById('maximizeBtn').addEventListener('click', () => {
            if (electronAPI) electronAPI.send('maximize-window');
        });

        document.getElementById('closeBtn').addEventListener('click', () => {
            if (electronAPI) electronAPI.send('close-window');
        });

        // Monitor de RAM (Windows)
        setInterval(() => {
            if (performance.memory) {
                const used = Math.round(performance.memory.usedJSHeapSize / (1024 * 1024));
                document.getElementById('ramValue').textContent = used + ' MB';
            }
        }, 1000);

        // Sistema de saves com Electron
        class WindowsSaveManager {
            constructor(game) {
                this.game = game;
                this.init();
            }

            async init() {
                if (!electronAPI) return;

                // Menu actions
                electronAPI.onMenuAction((event, action) => {
                    switch(action) {
                        case 'new-game':
                            this.game.startNewGame();
                            break;
                        case 'load-game':
                            this.showSaveManager();
                            break;
                        case 'save-game':
                            this.quickSave();
                            break;
                    }
                });

                // Graphics settings
                electronAPI.onGraphicsSetting((event, setting) => {
                    this.game.setGraphicsQuality(setting);
                });

                // Game ready
                electronAPI.onGameReady(() => {
                    console.log('Game ready for Windows');
                });
            }

            async quickSave() {
                const saveData = {
                    level: this.game.currentLevel,
                    sanity: this.game.sanity,
                    position: this.game.camera.position,
                    timestamp: Date.now()
                };

                const result = await electronAPI.saveGame(saveData);
                if (result.success) {
                    this.showNotification('Jogo salvo!', `Save em: ${result.path}`);
                }
            }

            async showSaveManager() {
                const saves = await electronAPI.getSaves();
                const manager = document.getElementById('saveManager');
                const list = document.getElementById('saveList');
                
                list.innerHTML = '';
                saves.forEach(save => {
                    const item = document.createElement('div');
                    item.className = 'save-item';
                    item.innerHTML = `
                        <span>${save.name}</span>
                        <span>${new Date(save.time).toLocaleString()}</span>
                        <button class="load-save" data-file="${save.name}">CARREGAR</button>
                    `;
                    list.appendChild(item);
                });

                manager.style.display = 'flex';
            }

            showNotification(title, body) {
                if (electronAPI) {
                    electronAPI.showNotification(title, body);
                }
            }
        }

        // Backrooms Game (adaptado para Windows)
        class BackroomsGameWindows extends BackroomsGame {
            constructor() {
                super();
                this.saveManager = new WindowsSaveManager(this);
                this.setupWindowsFeatures();
            }

            setupWindowsFeatures() {
                // F11 fullscreen
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'F11') {
                        e.preventDefault();
                        if (electronAPI) {
                            electronAPI.setFullScreen(!document.fullscreenElement);
                        }
                    }
                });

                // Exit button
                document.getElementById('exitBtn').addEventListener('click', () => {
                    if (confirm('Deseja sair do jogo?')) {
                        if (electronAPI) {
                            electronAPI.send('close-window');
                        }
                    }
                });

                // Load game button
                document.getElementById('loadGameBtn').addEventListener('click', () => {
                    this.saveManager.showSaveManager();
                });

                document.getElementById('closeSaveManager').addEventListener('click', () => {
                    document.getElementById('saveManager').style.display = 'none';
                });
            }

            setGraphicsQuality(quality) {
                switch(quality) {
                    case 'low':
                        this.renderer.setPixelRatio(1);
                        this.scene.fog.far = 20;
                        break;
                    case 'medium':
                        this.renderer.setPixelRatio(1.5);
                        this.scene.fog.far = 30;
                        break;
                    case 'high':
                        this.renderer.setPixelRatio(2);
                        this.scene.fog.far = 50;
                        break;
                }
            }

            startNewGame() {
                this.currentLevel = 0;
                this.sanity = 100;
                this.startGame();
            }
        }

        // Iniciar jogo
        document.addEventListener('DOMContentLoaded', () => {
            const game = new BackroomsGameWindows();
            game.animate();
            window.game = game;
        });
    </script>
</body>
</html>
